<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>jquery.subDataTable</title>
    <link href="css/smoothness/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
    <script src="jquery-1.7.2.js"></script>
    <script src="jquery-ui-1.8.23.custom.min.js"></script>
    <script src="DataTables-1.9.4/jquery.dataTables.js"></script>
    <script src="jquery.nestedDataTables.js"></script>
    <link href="jquery.nestedDataTables.css" rel="stylesheet" />
    <script src="qunit-1.10.0.js"></script>
    <link href="qunit-1.10.0.css" rel="stylesheet" />
</head>
<body>
  <div id="qunit"></div>
  <div id="qunit-fixture"></div>
  <script src="jquery.nestedDataTables.test.js"></script>

    <script type="text/javascript">


        function getData(dt, wsParams) {
            var d = [
                { a: 'alpha', b: 'beta', c: 'gamma', d: 'delta' },
                { a: 'alpha2', b: 'beta2', c: 'gamma', d: 'delta' },
                { a: 'alpha3', b: 'beta3', c: 'gamma', d: 'delta' },
                { a: 'alpha4', b: 'beta4', c: 'gamma', d: 'delta' },
                { a: 'alpha5', b: 'beta5', c: 'gamma', d: 'delta' },
                { a: 'alpha6', b: 'beta6', c: 'gamma', d: 'delta' },
                { a: 'alpha7', b: 'beta7', c: 'gamma', d: 'delta' },
                { a: 'alpha8', b: 'beta8', c: 'gamma', d: 'delta' },
                { a: 'alpha9', b: 'beta9', c: 'gamma', d: 'delta' }
            ];

            dt.fnAddData(d);
        }

        $(function () {
            $('#t').nestedDataTables({
                dataSource: "WebService.asmx/GetStates",
                columns:
                    [
                        { mDataProp: "StateID", nestedDataTables: { key: true, paramName: "StateID" } },
                        { mDataProp: "StateName" },
                        { mDataProp: "Population" }
                    ],
                nestedDataTable:
                    {
                        dataSource: "WebService.asmx/GetCounties",
                        columns:
                            [
                                { mDataProp: "StateID", bVisible: false, nestedDataTables: { key: true, paramName: "StateID" } },
                                { mDataProp: "Name", nestedDataTables: { key: true, paramName: "CountyName" } },
                                { mDataProp: "AreaSqMi" },
                                { mDataProp: "Population" },
                                { mDataProp: "WebUrl" }
                            ],
                        nestedDataTable:
                            {
                                dataSource: "WebService.asmx/GetCities",
                                columns:
                                    [
                                        { mDataProp: "Name" },
                                        { mDataProp: "AreaSqMi" },
                                        { mDataProp: "Population" },
                                        { mDataProp: "WebUrl" }
                                    ],
                                nestedDataTable: null
                            }
                    }
            });

            $('#u').nestedDataTables({
                dataSource: "WebService.asmx/GetStates",
                columns:
                    [
                        { mDataProp: "StateID", nestedDataTables: { key: true, paramName: "StateID" } },
                        { mDataProp: "StateName" },
                        { mDataProp: "Population" }
                    ],
                nestedDataTable:
                    {
                        dataSource: "WebService.asmx/GetCounties",
                        columns:
                            [
                                { mDataProp: "StateID", bVisible: false, nestedDataTables: { key: true, paramName: "StateID" } },
                                { mDataProp: "Name", nestedDataTables: { key: true, paramName: "CountyName" } },
                                { mDataProp: "AreaSqMi" },
                                { mDataProp: "Population" },
                                { mDataProp: "WebUrl" }
                            ],
                        nestedDataTable:
                            {
                                dataSource: "WebService.asmx/GetCities",
                                columns:
                                    [
                                        { mDataProp: "Name" },
                                        { mDataProp: "AreaSqMi" },
                                        { mDataProp: "Population" },
                                        { mDataProp: "WebUrl" }
                                    ]
                            }
                    }
            });

            $('#v').nestedDataTables({
                dataSource: getData,
                columns:
                    [
                        { mDataProp: "a", nestedDataTables: { key: true } },
                        { mDataProp: "b" },
                        { mDataProp: "c" },
                        { mDataProp: "d" }
                    ],
                rowKeys: ['StateID'],
                nestedDataTable:
                    {
                        dataSource: getData,
                        columns:
                            [
                                { mDataProp: "a", nestedDataTables: { key: true } },
                                { mDataProp: "b", nestedDataTables: { key: true } },
                                { mDataProp: "c" },
                                { mDataProp: "d" }
                            ]
                    }
            });

            //setTimeout(TClick, 1000);
        });

        function TClick() {
            $('#t td.nestedDataTables-buttonCol')[0].click();
            setTimeout(T2Click, 1000);
        }

        function T2Click() {
            $('#t table.t-tbllevel1 td.nestedDataTables-buttonCol')[0].click();
        }
    </script>
    <table id="t" style="width:100%"></table>
    <table id="u" style="width:100%"></table>
    <table id="v" style="width:100%"></table>
</body>
</html>
